import glob 
import pandas as pd  
from pathlib import Path      



if __name__=='__main__':

	csv_dir = Path('../../../../sandbox/data/MalwareDatasets/MalwareDatasets/PDFMalware/')
	save_dir = Path('../../../../sandbox/data/MalwareDatasets/MalwareDatasets/PDFMalware/total/')

	frames = []
	filepaths = list(csv_dir.glob('*.csv'))
	for filepath in filepaths:

		name = str(filepath).split('/')[-1].split('.')[0]
		print(f'Processing: {name}')
		d = pd.read_csv(filepath,index_col='Fine name')
		d.index.name = 'sha256'

		d = d[d.Class.isin(['Malicious','Benign'])]
		d.to_csv(save_dir / 'pdfmalware.csv')
